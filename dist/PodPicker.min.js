/*!
 * Pod Picker - A Podcast Timeline Generator
 * https://github.com/RoberMac/PodPicker
 *
 * Copyright (c) 2015 RoberTu <robertu0717@gmail.com>
 * @license MIT
 * @version v0.2.4
 */
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();!function(e,t){var i=function(e){return"undefined"==typeof e},n=function(e){return"string"==typeof e},r=function(e){return"boolean"==typeof e},o=function(e){return e.constructor===Array},a=function(e){return e.constructor===Object},s=function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},l=function(e){return/^(?:(?:([01]?\d|2[0-3]):)?([0-5]?\d):)?([0-5]?\d)$/.test(e)},m=function(e,t){switch(e){case"type":throw new TypeError(t);default:throw new Error(t)}},u={container_param:"Pod Picker: `container` parameter is required",container_type:"Pod Picker: `container` parameter must be a string",container_elem:"Pod Picker: `container` parameter is not related to an existing ID",items_param:"Pod Picker: `items` parameter is required",items_type:"Pod Picker: `items` parameter must be an array",items_empty:"Pod Picker: `items` parameter cannot be an empty array",options_type:"Pod Picker: `options` parameter must be an object",options_audioElem_type:"Pod Picker: `options.audioElem` must be a string",options_timelineColor_type:"Pod Picker: `options.timelineColor` must be a string",options_isShowStartTime_type:"Pod Picker: `options.isShowStartTime` must be a boolean",options_timelineColor_type_value:"Pod Picker: `options.timelineColor` must be a hex color",audioFile_format:"Pod Picker: does not support MP3 file format",start_format:'Pod Picker: `start` time string must be "hh:mm:ss", "mm:ss" or "ss" format'},c=function(e){l(e)?null:m("default",u.start_format);var t=e.split(":"),i=t.length;switch(i){case 1:return 1*t[0];case 2:return 60*t[0]+1*t[1];case 3:return 60*t[0]*60+60*t[1]+1*t[2];default:m("default",u.start_format)}},p=function(){function l(e,t,i){_classCallCheck(this,l),this._preTime=0,this._itemsIndex=0,this._seekingIndex=0,this._startTimeSet=[],this.setParameters(e,t),this.setOptions(i),this.createTimeline()}return _createClass(l,[{key:"setParameters",value:function(e,r){i(e)?m("default",u.container_param):n(e)?this._container=t.getElementById(e):m("type",u.container_type),this._container?null:m("default",u.container_elem),i(r)?m("default",u.items_param):o(r)?r.length<=0?m("default",u.items_empty):null:m("type",u.items_type),this._items=r.sort(function(e,t){var e=c(e.start),t=c(t.start);return e>t?1:t>e?-1:0})}},{key:"setOptions",value:function(e){i(e)||a(e)?null:m("type",u.options_type),i(e.audioElem)||n(e.audioElem)?null:m("type",u.options_audioElem_type),i(e.timelineColor)?null:n(e.timelineColor)?s(e.timelineColor)?null:m("type",u.options_timelineColor_type_value):m("type",u.options_timelineColor_type),i(e.isShowStartTime)||r(e.isShowStartTime)?null:m("type",u.options_isShowStartTime_type),this._audioElem=e.audioElem?t.getElementById(e.audioElem):t.getElementsByTagName("audio")[0],this._timelineColor=e.timelineColor||"#CECECF",this._isShowStartTime=e.isShowStartTime||!1}},{key:"createTimeline",value:function(){function i(){for(var i=r._items,o=r._audioElem,a=t.createDocumentFragment(""),s=t.createElement("div"),l=t.createElement("span"),m=t.createElement("ul"),u=0,p=i.length;p>u;u++){var d=t.createElement("li"),_=t.createElement("span"),f=c(i[u].start),h=r._isShowStartTime?i[u].start+" - "+i[u].title:i[u].title;r._startTimeSet.push(f),function(i,n){i.addEventListener("click",function(){o.play(),o.currentTime=n,r._seekingIndex=e.setTimeout(function(){t.getElementById("pp-pointer").className="seeking"},500)})}(_,f),d.className="pp-item",_.appendChild(t.createTextNode(h)),d.appendChild(_),m.appendChild(d)}m.style.color=r._timelineColor,l.id="pp-pointer",s.id="pp-timeline",s.appendChild(m),s.appendChild(l),a.appendChild(s),r._container.appendChild(a),o.addEventListener("timeupdate",function(){var e=o.currentTime,t=r._startTimeSet,i=t.length;if(Math.abs(r._preTime-e)>1)for(var a=0;i>a;a++)t[a+1]?e>=t[a]&&e<=t[a+1]?n(a+1):null:e>=t[a]?n(a+1):null;else for(var a=0;i>a;a++)e>t[a]-1&&e<=t[a]+1&&r._itemsIndex!==a+1?n(a+1):null;r._preTime=e}),o.addEventListener("seeking",function(){o.pause()}),o.addEventListener("seeked",function(){e.clearTimeout(r._seekingIndex),o.play(),t.getElementById("pp-pointer").removeAttribute("class")})}function n(e){var i=t.getElementsByClassName("pp-item"),n=t.getElementById("pp-pointer"),o=i[0].offsetHeight;r._itemsIndex=e,i[e-1].children[0].className="currentSection";for(var a=0,s=i.length;s>a;a++)a!==e-1?i[a].children[0].removeAttribute("class"):null;n.style.top=e*o-o/2-6+"px"}var r=this,o=setInterval(function(){var e=r._audioElem.currentSrc;e&&(clearInterval(o),e.match(/\.mp3/i)?m("default",u.audioFile_format):i())},10)}}]),l}();e.PodPicker||(e.PodPicker=p)}(window,document);
//# sourceMappingURL=PodPicker.min.js.map