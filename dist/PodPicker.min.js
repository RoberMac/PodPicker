/*!
 * Pod Picker - A Podcast Timeline Generator
 * https://github.com/RoberMac/PodPicker
 *
 * Copyright (c) 2015 RoberTu <robertu0717@gmail.com>
 * @license MIT
 * @version v0.2.3
 */
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}();!function(e,t){var i=function(){function i(e,r,n){_classCallCheck(this,i),this.preTime=0,this.itemsIndex=0,this.seekingIndex=0,this.startTimeSet=[],i.isUndefined(e)?i.throwError("default",i.ERROR_MSG.param_container):i.isString(e)?this.container=t.getElementById(e):i.throwError("type",i.ERROR_MSG.type_container),this.container?null:i.throwError("default",i.ERROR_MSG.elem_container),i.isUndefined(r)?i.throwError("default",i.ERROR_MSG.param_items):i.isArray(r)?r.length<=0?i.throwError("default",i.ERROR_MSG.empty_items):null:i.throwError("type",i.ERROR_MSG.type_items),i.isUndefined(n)||i.isObject(n)?this.options=n||{}:i.throwError("type",i.ERROR_MSG.type_options);var o=this;this.items=r.sort(function(e,t){var e=o.convertTime(e.start),t=o.convertTime(t.start);return e>t?1:t>e?-1:0}),this.setup()}return _createClass(i,[{key:"setup",value:function(){var e=this;this.setOptions();var t=setInterval(function(){var r=e.audioElem.currentSrc;r&&(clearInterval(t),r.match(/\.mp3/i)?e.throwError("default",i.ERROR_MSG.format_audioFile):e.createTimeline())},10)}},{key:"setOptions",value:function(){var e=this.options;i.isUndefined(e.audioElem)||i.isString(e.audioElem)?null:i.throwError("type",i.ERROR_MSG.type_options_audioElem),i.isUndefined(e.timelineColor)?null:i.isString(e.timelineColor)?i.isHexColor(e.timelineColor)?null:i.throwError("type",i.ERROR_MSG.type_value_options_timelineColor):i.throwError("type",i.ERROR_MSG.type_options_timelineColor),i.isUndefined(e.isShowStartTime)||i.isBoolean(e.isShowStartTime)?null:i.throwError("type",i.ERROR_MSG.type_options_isShowStartTime),this.audioElem=e.audioElem?t.getElementById(e.audioElem):t.getElementsByTagName("audio")[0],this.timelineColor=e.timelineColor||"#CECECF",this.isShowStartTime=e.isShowStartTime}},{key:"createTimeline",value:function(){for(var i=this,r=this.items,n=this.audioElem,o=this.timelineColor,a=this.isShowStartTime,s=t.createDocumentFragment(""),l=t.createElement("div"),m=t.createElement("span"),u=t.createElement("ul"),c=0,p=r.length;p>c;c++){var d=t.createElement("li"),h=t.createElement("span"),f=this.convertTime(r[c].start),y=a?r[c].start+" - "+r[c].title:r[c].title;this.startTimeSet.push(f),function(r,o){r.addEventListener("click",function(){n.play(),n.currentTime=o,i.seekingIndex=e.setTimeout(function(){t.getElementById("pp-pointer").className="seeking"},500)})}(h,f),d.className="pp-item",h.appendChild(t.createTextNode(y)),d.appendChild(h),u.appendChild(d)}u.style.color=o,m.id="pp-pointer",l.id="pp-timeline",l.appendChild(u),l.appendChild(m),s.appendChild(l),this.container.appendChild(s),n.addEventListener("timeupdate",function(){var e=n.currentTime,t=i.startTimeSet,r=t.length;if(Math.abs(i.preTime-e)>1)for(var o=0;r>o;o++)t[o+1]?e>=t[o]&&e<=t[o+1]?i.setPointerPosition(o+1):null:e>=t[o]?i.setPointerPosition(o+1):null;else for(var o=0;r>o;o++)e>t[o]-1&&e<=t[o]+1&&i.itemsIndex!==o+1?i.setPointerPosition(o+1):null;i.preTime=e}),n.addEventListener("seeking",function(){n.pause()}),n.addEventListener("seeked",function(){e.clearTimeout(i.seekingIndex),n.play(),t.getElementById("pp-pointer").removeAttribute("class")})}},{key:"setPointerPosition",value:function(e){var i=t.getElementsByClassName("pp-item"),r=t.getElementById("pp-pointer"),n=i[0].offsetHeight;this.itemsIndex=e,i[e-1].children[0].className="currentSection";for(var o=0,a=i.length;a>o;o++)o!==e-1?i[o].children[0].removeAttribute("class"):null;r.style.top=e*n-n/2-6+"px"}},{key:"convertTime",value:function(e){i.isTimeString(e)?null:i.throwError("default",i.ERROR_MSG.format_start);var t=e.split(":"),r=t.length;switch(r){case 1:return 1*t[0];case 2:return 60*t[0]+1*t[1];case 3:return 60*t[0]*60+60*t[1]+1*t[2];default:i.throwError("default",i.ERROR_MSG.format_start)}}}],[{key:"throwError",value:function(e,t){switch(e){case"type":throw new TypeError(t);default:throw new Error(t)}}},{key:"isUndefined",value:function(e){return"undefined"==typeof e}},{key:"isString",value:function(e){return"string"==typeof e}},{key:"isBoolean",value:function(e){return"boolean"==typeof e}},{key:"isArray",value:function(e){return e.constructor===Array}},{key:"isObject",value:function(e){return e.constructor===Object}},{key:"isHexColor",value:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)}},{key:"isTimeString",value:function(e){return/^(?:(?:([01]?\d|2[0-3]):)?([0-5]?\d):)?([0-5]?\d)$/.test(e)}},{key:"ERROR_MSG",get:function(){return{param_container:"Pod Picker: `container` parameter is required",type_container:"Pod Picker: `container` parameter must be a string",elem_container:"Pod Picker: `container` parameter is not related to an existing ID",param_items:"Pod Picker: `items` parameter is required",type_items:"Pod Picker: `items` parameter must be an array",empty_items:"Pod Picker: `items` parameter cannot be an empty array",type_options:"Pod Picker: `options` parameter must be an object",type_options_audioElem:"Pod Picker: `options.audioElem` must be a string",type_options_timelineColor:"Pod Picker: `options.timelineColor` must be a string",type_options_isShowStartTime:"Pod Picker: `options.isShowStartTime` must be a boolean",type_value_options_timelineColor:"Pod Picker: `options.timelineColor` must be a hex color",format_audioFile:"Pod Picker: does not support MP3 file format",format_start:'Pod Picker: `start` time string must be "hh:mm:ss", "mm:ss" or "ss" format'}}}]),i}();e.PodPicker||(e.PodPicker=i)}(window,document);
//# sourceMappingURL=PodPicker.min.js.map