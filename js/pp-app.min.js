!function(){angular.module("angular-storage",["angular-storage.store"]),angular.module("angular-storage.cookieStorage",[]).service("cookieStorage",["$injector",function(e){var t=e.get("$cookieStore");this.set=function(e,r){return t.put(e,r)},this.get=function(e){return t.get(e)},this.remove=function(e){return t.remove(e)}}]),angular.module("angular-storage.internalStore",["angular-storage.localStorage","angular-storage.sessionStorage"]).factory("InternalStore",["$log","$injector",function(e,t){function r(e,r,o){this.namespace=e||null,this.delimiter=o||".",this.inMemoryCache={},this.storage=t.get(r||"localStorage")}return r.prototype.getNamespacedKey=function(e){return this.namespace?[this.namespace,e].join(this.delimiter):e},r.prototype.set=function(e,t){this.inMemoryCache[e]=t,this.storage.set(this.getNamespacedKey(e),JSON.stringify(t))},r.prototype.get=function(t){var r=null;if(t in this.inMemoryCache)return this.inMemoryCache[t];var o=this.storage.get(this.getNamespacedKey(t));try{r="undefined"==typeof o||"undefined"===o?void 0:JSON.parse(o),this.inMemoryCache[t]=r}catch(a){e.error("Error parsing saved value",a),this.remove(t)}return r},r.prototype.remove=function(e){this.inMemoryCache[e]=null,this.storage.remove(this.getNamespacedKey(e))},r}]),angular.module("angular-storage.localStorage",["angular-storage.cookieStorage"]).service("localStorage",["$window","$injector",function(e,t){var r=!!e.localStorage;if(r)try{e.localStorage.setItem("testKey","test"),e.localStorage.removeItem("testKey"),r=!0}catch(o){r=!1}if(r)this.set=function(t,r){return e.localStorage.setItem(t,r)},this.get=function(t){return e.localStorage.getItem(t)},this.remove=function(t){return e.localStorage.removeItem(t)};else{var a=t.get("cookieStorage");this.set=a.set,this.get=a.get,this.remove=a.remove}}]),angular.module("angular-storage.sessionStorage",["angular-storage.cookieStorage"]).service("sessionStorage",["$window","$injector",function(e,t){if(e.sessionStorage)this.set=function(t,r){return e.sessionStorage.setItem(t,r)},this.get=function(t){return e.sessionStorage.getItem(t)},this.remove=function(t){return e.sessionStorage.removeItem(t)};else{var r=t.get("cookieStorage");this.set=r.set,this.get=r.get,this.remove=r.remove}}]),angular.module("angular-storage.store",["angular-storage.internalStore"]).provider("store",function(){var e="localStorage";this.setStore=function(t){t&&angular.isString(t)&&(e=t)},this.$get=["InternalStore",function(t){var r=new t(null,e);return r.getNamespacedStore=function(e,r,o){return new t(e,r,o)},r}]})}();
angular.module("ppApp",["ngRoute","ngAnimate","angular-storage"]).config(["$routeProvider","$locationProvider",function(t,e){e.html5Mode(!1).hashPrefix("!"),t.when("/",{templateUrl:"template/first-contact.min.html",controller:"demoController"}).when("/postpicker",{templateUrl:"template/post-picker.min.html",controller:"postController"}).when("/guide",{templateUrl:"template/guide.min.html",controller:"guideController"}).otherwise({redirectTo:"/"})}]).controller("ppController",["$scope","$http","$templateCache",function(t,e,o){t.isLoaded=!0,e.get("template/guide.min.html",{cache:o})}]).controller("demoController",["$rootScope",function(t){t.currentPage="demo";var e=[{start:"00:00",title:"開始"},{start:"01:42",title:"會員廣告"},{start:"04:43",title:"聽眾反饋一：虛擬現實"},{start:"20:40",title:"聽眾反饋二"},{start:"28:20",title:"Rio 的 Apple Watch 体验"},{start:"48:53",title:"和《IT 公论》「抢生意」的 Vox + LOOP"},{start:"01:07:05",title:"Mike Matas 新作、Facebook 的 Instant Articles"},{start:"01:19:22",title:"URL 的終結？"},{start:"01:49:53",title:"App 推薦"},{start:"01:52:03",title:"結束"}];setTimeout(function(){new PodPicker("pp-wrapper",e)},0)}]).controller("postController",["$scope","$rootScope","$timeout","store",function(t,e,o,n){function i(t){var e=parseInt(t,10),o=Math.floor(e/3600),n=Math.floor((e-3600*o)/60),i=e-3600*o-60*n;return[o,n,i]}function s(t){var e=t.h,o=t.m,n=t.s,i=10>e?"0"+e:e,s=10>o?"0"+o:o,a=10>n?"0"+n:n,c=i+":"+s+":"+a;return c}function a(){m=document.getElementById("audio_player"),u=angular.element(m)}function c(){a(),u.bind("pause",function(){if(Object.getOwnPropertyNames(t.newSection).length<=0){var e=i(m.currentTime),o={h:e[0],m:e[1],s:e[2]};t.$apply(function(){t.newSection.start=o})}}),u.bind("timeupdate",function(){p.set("lastPlayTime",m.currentTime)})}function r(){var e=angular.element(document.getElementById("pp-timeline"));e&&e.remove();new PodPicker("pp-wrapper",t.sectionItemsData,{isShowStartTime:!0})}function l(){for(var e=t.sectionItems.length,o=[],n=0;e>n;n++)o.push({start:s(t.sectionItems[n].original_start),title:t.sectionItems[n].title});t.sectionItemsData=o}e.currentPage="post",t.isConsole=!0,t.isLoadAudioFile=!0;var m,u,p,I=document.getElementById("audio_file"),d=angular.element(I);c(),d.bind("change",function(){var e=I.files[0],i=e.lastModified+e.name;p=n.getNamespacedStore(i),t.$apply(function(){t.isLoadAudioFile=!1,t.isConsole=!1,m.src=URL.createObjectURL(e),o(function(){m.currentTime=p.get("lastPlayTime")},100)}),t.sectionItems=p.get("sectionItems")||[],t.sectionItemsData=p.get("sectionItemsData")||[]}),t.skip=function(t){m.currentTime+=t,m.play()},t.toggleRate=function(){var t=angular.element(document.getElementById("rate_icon"));2===m.playbackRate?(m.playbackRate=1,t.removeClass("reversion")):(m.playbackRate=2,t.addClass("reversion")),m.play()},t.refreshStartTime=function(){var e=i(m.currentTime),o={h:e[0],m:e[1],s:e[2]};t.newSection.original_start=o,document.getElementById("section_title").focus()},t.toggleSectionItems=function(){var e=t.isShowSectionItems,o=t.sectionItems.length>0;if(!e&&o)u.replaceWith(u.clone()),a(),r();else{if(!e||!o)return;m.currentTime=p.get("lastPlayTime"),c()}t.isShowSectionItems=!t.isShowSectionItems},t.toggleEditSectionItems=function(){t.isEditSectionItems?(t.sectionItems=angular.copy(t.editSectionItems),l(),r()):t.editSectionItems=angular.copy(t.sectionItems),t.isEditSectionItems=!t.isEditSectionItems},t.undoSectionItems=function(){t.isEditSectionItems=!t.isEditSectionItems},t.deleteItem=function(e){t.sectionItems.splice(e,1),t.sectionItemsData.splice(e,1)},t.clearSectionItems=function(){t.toggleSectionItems(),t.sectionItems=[],t.sectionItemsData=[],p.remove("sectionItems"),p.remove("sectionItemsData"),t.isEditSectionItems=!t.isEditSectionItems,t.isShowAlert=!1},t.toggleShowAlert=function(){t.isShowAlert=!t.isShowAlert},t.toggleItemsData=function(){t.isShowItemsData=!t.isShowItemsData},t.sectionItems=[],t.sectionItemsData=[],t.editSectionItems=[],t.newSection={},t.isShowSectionItems=!1,t.isEditSectionItems=!1,t.isShowItemsData=!1,t.isShowAlert=!1,t.sectionSubmit=function(){t.sectionItems.push(t.newSection),t.sectionItemsData.push({start:s(t.newSection.original_start),title:t.newSection.title}),t.newSection={};var e=angular.element(document.getElementById("items_icon"));e.addClass("reversion"),o(function(){e.removeClass("reversion"),m.play()},717)},t.$watchCollection("sectionItems",function(t){console.log("sectionItems Change",t),p.set("sectionItems",t)}),t.$watchCollection("sectionItemsData",function(t){console.log("sectionItemsData Change",t),p.set("sectionItemsData",t)})}]).controller("guideController",["$rootScope",function(t){t.currentPage="guide"}]);
//# sourceMappingURL=pp-app.min.js.map