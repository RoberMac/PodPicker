{"version":3,"sources":["angular-storage.min.js","pp-app.js"],"names":["angular","module","service","e","t","get","this","set","r","put","remove","factory","o","namespace","delimiter","inMemoryCache","storage","prototype","getNamespacedKey","join","JSON","stringify","parse","a","error","localStorage","setItem","removeItem","getItem","sessionStorage","provider","setStore","isString","$get","getNamespacedStore","config","$routeProvider","$locationProvider","html5Mode","hashPrefix","when","templateUrl","controller","otherwise","redirectTo","$scope","$http","$templateCache","isLoaded","cache","$rootScope","currentPage","itgonglun","start","title","setTimeout","PodPicker","$timeout","store","secNumToTimeArray","secNum","sec_num","parseInt","hours","Math","floor","minutes","seconds","secObjToTimeString","secObj","start_h","h","start_m","m","start_s","s","timeString","refreshAudioFile","audioPlayer","document","getElementById","ngAudioPlayer","element","listenAudioFile","bind","Object","getOwnPropertyNames","newSection","length","timeArray","currentTime","timeObject","$apply","audioStore","refreshTimeline","ngTimeline","sectionItemsData","isShowStartTime","refreshSectionItemsData","len","sectionItems","i","push","original_start","isConsole","isLoadAudioFile","audioFile","ngAudioFile","file","files","audioFileIndex","lastModified","name","src","URL","createObjectURL","skip","sec","play","toggleRate","rateIcon","playbackRate","removeClass","addClass","refreshStartTime","focus","editSectionItems","isShowSectionItems","isEditSectionItems","isShowItemsData","isShowAlert","isDeleteItem","sectionSubmit","itemsIcon","toggleSectionItems","isEmpty","replaceWith","clone","toggleEditSectionItems","toggleShowAlert","copy","toggleDeleteItem","deleteItem","index","splice","$watchCollection","newVal","alertTitle","alertAction","ok","action","equals","toggleItemsData","blob","Blob","type","url","elem","download","href"],"mappings":"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","file":"pp-app.min.js","sourcesContent":["!function(){angular.module(\"angular-storage\",[\"angular-storage.store\"]),angular.module(\"angular-storage.cookieStorage\",[]).service(\"cookieStorage\",[\"$injector\",function(e){var t=e.get(\"$cookieStore\");this.set=function(e,r){return t.put(e,r)},this.get=function(e){return t.get(e)},this.remove=function(e){return t.remove(e)}}]),angular.module(\"angular-storage.internalStore\",[\"angular-storage.localStorage\",\"angular-storage.sessionStorage\"]).factory(\"InternalStore\",[\"$log\",\"$injector\",function(e,t){function r(e,r,o){this.namespace=e||null,this.delimiter=o||\".\",this.inMemoryCache={},this.storage=t.get(r||\"localStorage\")}return r.prototype.getNamespacedKey=function(e){return this.namespace?[this.namespace,e].join(this.delimiter):e},r.prototype.set=function(e,t){this.inMemoryCache[e]=t,this.storage.set(this.getNamespacedKey(e),JSON.stringify(t))},r.prototype.get=function(t){var r=null;if(t in this.inMemoryCache)return this.inMemoryCache[t];var o=this.storage.get(this.getNamespacedKey(t));try{r=\"undefined\"==typeof o||\"undefined\"===o?void 0:JSON.parse(o),this.inMemoryCache[t]=r}catch(a){e.error(\"Error parsing saved value\",a),this.remove(t)}return r},r.prototype.remove=function(e){this.inMemoryCache[e]=null,this.storage.remove(this.getNamespacedKey(e))},r}]),angular.module(\"angular-storage.localStorage\",[\"angular-storage.cookieStorage\"]).service(\"localStorage\",[\"$window\",\"$injector\",function(e,t){var r=!!e.localStorage;if(r)try{e.localStorage.setItem(\"testKey\",\"test\"),e.localStorage.removeItem(\"testKey\"),r=!0}catch(o){r=!1}if(r)this.set=function(t,r){return e.localStorage.setItem(t,r)},this.get=function(t){return e.localStorage.getItem(t)},this.remove=function(t){return e.localStorage.removeItem(t)};else{var a=t.get(\"cookieStorage\");this.set=a.set,this.get=a.get,this.remove=a.remove}}]),angular.module(\"angular-storage.sessionStorage\",[\"angular-storage.cookieStorage\"]).service(\"sessionStorage\",[\"$window\",\"$injector\",function(e,t){if(e.sessionStorage)this.set=function(t,r){return e.sessionStorage.setItem(t,r)},this.get=function(t){return e.sessionStorage.getItem(t)},this.remove=function(t){return e.sessionStorage.removeItem(t)};else{var r=t.get(\"cookieStorage\");this.set=r.set,this.get=r.get,this.remove=r.remove}}]),angular.module(\"angular-storage.store\",[\"angular-storage.internalStore\"]).provider(\"store\",function(){var e=\"localStorage\";this.setStore=function(t){t&&angular.isString(t)&&(e=t)},this.$get=[\"InternalStore\",function(t){var r=new t(null,e);return r.getNamespacedStore=function(e,r,o){return new t(e,r,o)},r}]})}();","angular.module('ppApp', ['ngRoute', 'ngAnimate', 'angular-storage'])\n.config(['$routeProvider','$locationProvider', function($routeProvider, $locationProvider) {\n    $locationProvider.html5Mode(false).hashPrefix('!');\n\n    $routeProvider.\n      when('/', {\n            templateUrl: 'template/first-contact.min.html',\n            controller: 'demoController'\n      }).\n      when('/postpicker', {\n            templateUrl: 'template/post-picker.min.html',\n            controller: 'postController'\n      }).\n      when('/guide', {\n            templateUrl: 'template/guide.min.html',\n            controller: 'guideController'\n      }).\n      otherwise({\n            redirectTo: '/'\n      });\n\n}])\n.controller('ppController', ['$scope', '$http', '$templateCache', function($scope, $http, $templateCache){\n\n    // 開場動畫結束\n    $scope.isLoaded = true\n    // 預加載「The Picker's Guide」模板，預防從「PostPicker」跳轉來時失效\n    $http.get('template/guide.min.html', {\n        cache: $templateCache\n    })\n\n}])\n.controller('demoController', ['$rootScope', function($rootScope){\n\n    $rootScope.currentPage = 'demo'\n    var itgonglun = [\n        {\"start\": \"00:00\", \"title\": \"開始\"},\n        {\"start\": \"01:42\", \"title\": \"會員廣告\"},\n        {\"start\": \"04:43\", \"title\": \"聽眾反饋一：虛擬現實\"},\n        {\"start\": \"20:40\", \"title\": \"聽眾反饋二\"},\n        {\"start\": \"28:20\", \"title\": \"Rio 的 Apple Watch 体验\"},\n        {\"start\": \"48:53\", \"title\": \"和《IT 公论》「抢生意」的 Vox + LOOP\"},\n        {\"start\": \"01:07:05\", \"title\": \"Mike Matas 新作、Facebook 的 Instant Articles\"},\n        {\"start\": \"01:19:22\", \"title\": \"URL 的終結？\"},\n        {\"start\": \"01:49:53\", \"title\": \"App 推薦\"},\n        {\"start\": \"01:52:03\", \"title\": \"結束\"}\n    ]\n    setTimeout(function (){\n        var pp = new PodPicker('pp-wrapper', itgonglun)\n    }, 0)\n}])\n.controller('postController', ['$scope', '$rootScope', '$timeout', 'store', function($scope, $rootScope, $timeout, store){\n\n    $rootScope.currentPage = 'post'\n    $scope.isConsole       = true\n    $scope.isLoadAudioFile = true\n\n    var audioFile   = document.getElementById('audio_file'),\n        ngAudioFile = angular.element(audioFile),\n        audioPlayer, ngAudioPlayer, audioFileSrc,\n        audioStore; // 用於存儲該音頻文件編輯／播放信息\n\n    listenAudioFile()\n\n    // 載入音頻文件\n    ngAudioFile.bind('change', function (){\n        var file = audioFile.files[0],\n            audioFileIndex = file.lastModified + file.name; // 音頻文件 ID，方便存儲數據與本地\n        // 初始化用戶存儲該音頻文件的命名空間\n        audioStore = store.getNamespacedStore(audioFileIndex)\n        // 加載音頻文件 \n        $scope.$apply(function (){\n            $scope.isLoadAudioFile = false\n            $scope.isConsole = false\n            audioPlayer.src = URL.createObjectURL(file)\n            $timeout(function (){\n                audioPlayer.currentTime = audioStore.get('lastPlayTime')\n            }, 100)\n        })\n        // 恢復上次編輯的數據\n        $scope.sectionItems = audioStore.get('sectionItems') || []\n        $scope.sectionItemsData = audioStore.get('sectionItemsData') || []\n    })\n\n\n    /**\n     * 音頻控制\n     *\n     */\n    $scope.skip = function (sec){\n        audioPlayer.currentTime += sec\n        audioPlayer.play()\n    }\n    $scope.toggleRate = function (){\n        var rateIcon = angular.element(document.getElementById('rate_icon'))\n        if (audioPlayer.playbackRate === 2){\n            audioPlayer.playbackRate = 1\n            rateIcon.removeClass('sprite-Rate-2x-Selected')\n            rateIcon.addClass('sprite-Rate-2x')\n        } else {\n            audioPlayer.playbackRate = 2\n            rateIcon.removeClass('sprite-Rate-2x')\n            rateIcon.addClass('sprite-Rate-2x-Selected')\n        }\n        audioPlayer.play()\n    }\n    $scope.refreshStartTime = function (){\n        var timeArray = secNumToTimeArray(audioPlayer.currentTime),\n            timeObject = {\n                \"h\": timeArray[0],\n                \"m\": timeArray[1],\n                \"s\": timeArray[2]\n            };\n        $scope.newSection.original_start = timeObject\n        document.getElementById('section_title').focus()\n    }\n\n\n    /**\n     * 章節編輯\n     *\n     */\n    /* 章節 */\n    $scope.sectionItems       = []    // 緩存數據項（用於編輯）\n    $scope.sectionItemsData   = []    // 緩存數據項（用於「時間線」／導出）\n    $scope.editSectionItems   = []    // 緩存正在編輯的數據項\n    $scope.newSection         = {}    // 新增數據項\n    $scope.isShowSectionItems = false // 是否顯示時間線\n    $scope.isEditSectionItems = false // 是否顯示編輯項\n    $scope.isShowItemsData    = false // 是否顯示「導出」數據\n    $scope.isShowAlert        = false // 是否顯示提示框\n    $scope.isDeleteItem       = false // 是否顯示刪除數據項按鈕\n    $scope.sectionSubmit = function (){\n        // 存儲「新章節」\n        $scope.sectionItems.push($scope.newSection)\n        $scope.sectionItemsData.push({\n            'start': secObjToTimeString($scope.newSection.original_start),\n            'title': $scope.newSection.title\n        })\n        // 存儲完成，清除數據\n        $scope.newSection = {}\n        // 動畫提醒\n        var itemsIcon  = angular.element(document.getElementById('items_icon'));\n        itemsIcon.removeClass('sprite-Section-Items')\n        itemsIcon.addClass('sprite-Section-Items-Selected')\n        $timeout(function (){\n            itemsIcon.removeClass('sprite-Section-Items-Selected')\n            itemsIcon.addClass('sprite-Section-Items')\n            // 繼續播放\n            audioPlayer.play()\n        }, 717)\n    }\n    /* 顯示／隱藏「時間線」演示 */\n    $scope.toggleSectionItems = function (){\n        var isShowSectionItems = $scope.isShowSectionItems,\n            isEmpty            = $scope.sectionItems.length <= 0;\n        if (!isShowSectionItems && !isEmpty){\n            // 顯示「時間線」\n            // 移除 `audioPlayer` 元素上的所有 Event Listeners\n            ngAudioPlayer.replaceWith(ngAudioPlayer.clone())\n            refreshAudioFile()\n            refreshTimeline()\n        } else if (isShowSectionItems && !isEmpty){\n            // 隱藏時間線\n            // 還原上次播放時間\n            audioPlayer.currentTime = audioStore.get('lastPlayTime')\n            listenAudioFile()\n        } else {\n            return\n        }\n        $scope.isShowSectionItems = !$scope.isShowSectionItems\n    }\n    /* 顯示／隱藏（保存）編輯數據項 */\n    $scope.toggleEditSectionItems = function (){\n\n        if ($scope.isEditSectionItems){\n            if ($scope.editSectionItems.length <= 0){\n                $scope.toggleShowAlert('DELETE ALL DATA', 'clearSectionItems')\n                return;\n            }\n            // 隱藏編輯數據項\n            // 更新「時間線」\n            $scope.sectionItems = angular.copy($scope.editSectionItems)\n            refreshSectionItemsData()\n            refreshTimeline()\n        } else {\n            // 顯示編輯數據項\n            $scope.editSectionItems = angular.copy($scope.sectionItems)\n            $scope.isDeleteItem = false\n        }\n        $scope.isEditSectionItems = !$scope.isEditSectionItems\n    }\n    /* 顯示／隱藏刪除按鈕 */\n    $scope.toggleDeleteItem = function (){\n        $scope.isDeleteItem = !$scope.isDeleteItem\n    }\n    /* 刪除單項數據 */\n    $scope.deleteItem = function (index){\n        $scope.editSectionItems.splice(index, 1)        \n    }\n    // 監聽 `sectionItems` & `sectionItemsData` 改動，自動存儲於本地\n    $scope.$watchCollection('sectionItems', function (newVal){\n        audioStore.set('sectionItems', newVal)\n    })\n    $scope.$watchCollection('sectionItemsData', function (newVal){\n        audioStore.set('sectionItemsData', newVal)\n    })\n\n\n    /**\n     * 提示框\n     *\n     */\n    $scope.alertTitle = ''\n    $scope.alertAction = ''\n    $scope.ok = function (){\n        if ($scope.alertAction === 'clearSectionItems'){\n            /* 清空所有數據 */\n            $scope.toggleSectionItems()\n            $scope.sectionItems = []\n            $scope.sectionItemsData = []\n        }\n        $scope.isEditSectionItems = !$scope.isEditSectionItems\n        $scope.isShowAlert = false\n    }\n    /* 顯示／隱藏提示框 */\n    $scope.toggleShowAlert = function (title, action){\n        // 當數據沒改動過，直接退出\n        if (title === 'UNDO ALL CHANGES' && angular.equals($scope.editSectionItems, $scope.sectionItems)){\n            $scope.isEditSectionItems = !$scope.isEditSectionItems\n            $scope.isShowAlert = false\n            return;\n        }\n        // 設置「提示框」標題 & 「同意」後的動作\n        $scope.alertTitle = title ? title : null\n        $scope.alertAction = action ? action : null\n        $scope.isShowAlert = !$scope.isShowAlert\n    }\n    /* 顯示／隱藏數據 */\n    $scope.toggleItemsData = function (){\n        if (!$scope.isShowItemsData){\n            var blob = new Blob([JSON.stringify($scope.sectionItemsData)], {type: \"application/json\"}),\n                url  = URL.createObjectURL(blob),\n                elem = document.getElementById('downloadItemsData')\n            elem.download = 'items_data.json'\n            elem.href     = url\n        }\n        $scope.isShowItemsData = !$scope.isShowItemsData\n    }\n\n    /**\n     * Helper\n     *\n     */\n    // via http://stackoverflow.com/a/6313008/3786947\n    function secNumToTimeArray(secNum){\n        var sec_num = parseInt(secNum, 10),\n            hours   = Math.floor(sec_num / 3600),\n            minutes = Math.floor((sec_num - (hours * 3600)) / 60),\n            seconds = sec_num - (hours * 3600) - (minutes * 60);\n        return [hours, minutes, seconds]\n    }\n    function secObjToTimeString (secObj){\n        var start_h    = secObj.h,\n            start_m    = secObj.m,\n            start_s    = secObj.s,\n            h          = start_h < 10 ? '0' + start_h : start_h,\n            m          = start_m < 10 ? '0' + start_m : start_m,\n            s          = start_s < 10 ? '0' + start_s : start_s,\n            timeString =  h + ':' + m + ':' + s;\n        return timeString\n    }\n    function refreshAudioFile(){\n        // 刷新元素引用\n        audioPlayer    = document.getElementById('audio_player')\n        ngAudioPlayer  = angular.element(audioPlayer)\n    }\n    function listenAudioFile(){\n        refreshAudioFile()\n        // 判斷是否需要更新時間\n        ngAudioPlayer.bind('pause', function (){\n            if (Object.getOwnPropertyNames($scope.newSection).length <= 0){\n                var timeArray  = secNumToTimeArray(audioPlayer.currentTime),\n                    timeObject = {\n                        \"h\": timeArray[0],\n                        \"m\": timeArray[1],\n                        \"s\": timeArray[2]\n                    };\n                $scope.$apply(function (){\n                    $scope.newSection.start = timeObject\n                })\n            }\n        })\n        // 存儲當前播放時間\n        ngAudioPlayer.bind('timeupdate', function (){\n            audioStore.set('lastPlayTime', audioPlayer.currentTime)\n        })\n    }\n    // 刷新「時間線」\n    function refreshTimeline(){\n        var ngTimeline = angular.element(document.getElementById('pp-timeline'))\n        if (ngTimeline){\n            ngTimeline.remove()\n        }\n        var pp = new PodPicker('pp-wrapper', $scope.sectionItemsData, {\n            \"isShowStartTime\": true\n        })\n    }\n    // 刷新章節（導出）數據\n    function refreshSectionItemsData (){\n        var len   = $scope.sectionItems.length,\n            cache = [];\n        for (var i = 0; i < len; i++){\n            cache.push({\n                'start': secObjToTimeString($scope.sectionItems[i].original_start),\n                'title': $scope.sectionItems[i].title\n            })\n        }\n        $scope.sectionItemsData = cache\n    }\n}])\n.controller('guideController', ['$rootScope', function($rootScope){\n\n    $rootScope.currentPage = 'guide'\n}])\n"],"sourceRoot":"/source/"}